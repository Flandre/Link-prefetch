<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title></title>
</head>
<body>

<img src="" data-src="test/img/001.jpg">
<img src="" data-src="test/img/002.jpg">
<script src="js/jquery.min.js"></script>
<script>
  $('img').each(function(){
    getSource($(this).attr('data-src'), '',function(data){
      console.log(data)
    })
    /*var imgDom = $(this);
    var img = new Image();
    img.src = $(this).attr('data-src');
    img.onload = function(){
      //alert(imgDom.attr('data-src'));
      imgDom.attr('src',imgDom.attr('data-src'));
      //alert(2)
    }*/

  });

  //发起ajax请求
  function getSource(url, type, func) {
    $.get({
      url: url,
      dataType: type,
      success: func,
      xhr: function() {
        // 获取JQuery内部使用的XMLHttpRequest对象
        var xhr = $.ajaxSettings.xhr();
        // 下载进度监控
        xhr.addEventListener('progress', download_progress_handler, false);
        return xhr;//一定要返回，不然jQ没有XHR对象用了
      }
    });
  }
  function download_progress_handler (e) {
    if (e.lengthComputable) {
      var percentComplete = e.loaded / e.total;
      console.log(percentComplete);
      // ...
    } else {
      // 不能计算进度
    }
  }
</script>
</body>
</html>